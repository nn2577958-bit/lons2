<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ë¼ë‹ˆ MALL - í™ˆ</title>
<style>
* {box-sizing:border-box;margin:0;padding:0}
body {
  min-height:100vh;
  font-family:'Segoe UI',sans-serif;
  background:
    radial-gradient(circle at top, rgba(15,23,42,.7), rgba(15,23,42,.95)),
    url('https://cdn.phototourl.com/uploads/2026-02-18-2239f19c-5c7f-4c1e-b1c1-731bf5606151.webp') center/cover no-repeat;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  padding:20px;
  color:#fff;
  gap:20px;
}

/* ë©”ì¸ ì¹´ë“œ ì»¨í…Œì´ë„ˆ */
.container {
  width:92vw;
  max-width:960px;
  padding:24px 24px 22px;
  background:rgba(15,23,42,.82);
  backdrop-filter:blur(12px);
  border-radius:22px;
  border:1px solid rgba(148,163,184,.35);
  box-shadow:0 22px 50px rgba(15,23,42,.9);
  display:flex;
  flex-direction:column;
  gap:18px;
}

/* ìƒë‹¨ ìƒíƒœ + í—¤ë” ë¼ì¸ */
.top-row {
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:12px;
}
#status {
  font-size:12px;
  font-weight:600;
  padding:6px 12px;
  background:rgba(34,197,94,.15);
  border-radius:999px;
  border:1px solid rgba(34,197,94,.3);
}
.header-info {text-align:right}
.mall-name {font-size:18px;font-weight:800;letter-spacing:.03em}
.mall-sub {font-size:12px;color:rgba(209,213,219,.9)}

/* í™˜ì˜ ë¬¸êµ¬ */
#welcome {
  font-size:20px;
  font-weight:700;
  background:linear-gradient(135deg,#e5e7eb,#f9fafb);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  text-align:left;
}

/* ì¹´í…Œê³ ë¦¬ íƒ­ */
.tabs {
  display:flex;
  flex-wrap:wrap;
  gap:8px;
  margin-top:-4px;
}
.tab {
  padding:6px 12px;
  border-radius:999px;
  border:1px solid rgba(148,163,184,.5);
  font-size:11px;
  color:rgba(209,213,219,.9);
  cursor:pointer;
  background:rgba(15,23,42,.85);
  transition:all .2s;
}
.tab.active {
  background:linear-gradient(135deg,#3b82f6,#22c55e);
  border-color:transparent;
  color:#f9fafb;
  box-shadow:0 6px 14px rgba(37,99,235,.55);
}

/* ìƒí’ˆ ê·¸ë¦¬ë“œ */
#product-list {
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:18px;
  width:100%;
  margin-top:4px;
}

/* ìƒí’ˆ ì¹´ë“œ */
.product {
  width:100%;
  max-width:260px;
  background:radial-gradient(circle at top left, rgba(148,163,184,.25), transparent 55%),
             rgba(15,23,42,.9);
  backdrop-filter:blur(10px);
  border:1px solid rgba(148,163,184,.45);
  padding:18px 16px 14px;
  border-radius:16px;
  transition:all .3s;
  position:relative;
  overflow:hidden;
  display:flex;
  flex-direction:column;
  align-items:flex-start;
}

.product::before {
  content:'';
  position:absolute;
  inset:-40%;
  background:radial-gradient(circle at 0% 0%, rgba(56,189,248,.28), transparent 60%);
  opacity:0;
  transition:opacity .3s;
  pointer-events:none;
}

.product:hover::before {opacity:1}

.product:hover {
  transform:translateY(-6px);
  box-shadow:0 18px 28px rgba(15,23,42,.75);
  border-color:rgba(56,189,248,.6);
}

.product h3 {
  margin:0 0 6px;
  font-size:15px;
  font-weight:700;
  color:#f9fafb;
}
  
.product p {
  margin:0 0 6px;
  font-size:14px;
  font-weight:600;
  background:linear-gradient(135deg,#4ade80,#22c55e);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}
.product small {
  color:rgba(209,213,219,.88);
  font-size:12px;
  display:block;
  margin-bottom:10px;
}
.product-footer {
  width:100%;
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:8px;
  margin-top:auto;
}
.badge {
  padding:4px 8px;
  border-radius:999px;
  border:1px solid rgba(148,163,184,.6);
  font-size:10px;
  color:rgba(209,213,219,.9);
}

/* êµ¬ë§¤í•˜ê¸° ë²„íŠ¼ */
.buy-btn {
  padding: 6px 12px;
  border-radius: 999px;
  border: none;
  cursor: pointer;
  font-size: 12px;
  font-weight: 600;
  color: #0f172a;
  background: linear-gradient(135deg,#4ade80,#22c55e);
  box-shadow: 0 6px 14px rgba(34,197,94,.45);
  transition: transform .15s, box-shadow .15s, background .15s;
}
.buy-btn:hover {
  transform: translateY(-1px);
  box-shadow: 0 10px 18px rgba(34,197,94,.55);
}

/* í•˜ë‹¨ ë²„íŠ¼ ì¤„ */
.btn-row {
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:16px;
  flex-wrap:wrap;
  margin-top:6px;
}
.logout-btn, .discord-btn, .inquiry-main-btn, .reset-btn {
  padding:9px 18px;
  border:none;
  border-radius:999px;
  cursor:pointer;
  font-weight:600;
  font-size:13px;
  color:#fff;
  transition:all .2s;
  box-shadow:0 4px 15px rgba(15,23,42,.7);
}
.logout-btn {background:linear-gradient(135deg,#d32f2f,#b71c1c)}
.logout-btn:hover {background:linear-gradient(135deg,#b71c1c,#7f0000);transform:translateY(-1px)}
.discord-btn {background:linear-gradient(135deg,#5865F2,#404EED)}
.discord-btn:hover {background:linear-gradient(135deg,#404EED,#2833C4);transform:translateY(-1px)}
.inquiry-main-btn {background:linear-gradient(135deg,#22c55e,#16a34a)}
.inquiry-main-btn:hover {background:linear-gradient(135deg,#16a34a,#15803d);transform:translateY(-1px)}
.reset-btn {background:linear-gradient(135deg,#0ea5e9,#2563eb)}
.reset-btn:hover {background:linear-gradient(135deg,#2563eb,#1d4ed8);transform:translateY(-1px)}

/* ë°˜ì‘í˜• */
@media (min-width:1024px) {
  #product-list{grid-template-columns:repeat(3,1fr)}
}
@media (max-width:768px) {
  .container{padding:20px 18px}
  #product-list{grid-template-columns:repeat(2,1fr);gap:14px}
  .btn-row{flex-direction:column;align-items:stretch}
}
@media (max-width:480px) {
  .container{padding:18px;max-width:95vw}
  #welcome{font-size:18px}
  #product-list{grid-template-columns:1fr;gap:12px}
}
</style>
</head>
<body>
<div class="container">
  <div class="top-row">
    <div id="status">ğŸŸ¢ ì˜¨ë¼ì¸</div>
    <div class="header-info">
      <div class="mall-name">ë¼ë‹ˆ MALL</div>
      <div class="mall-sub">ë””ìŠ¤ì½”ë“œ ë´‡ Â· ì„œë²„ ì„¸íŒ… Â· ë¡œê³  ë””ìì¸</div>
    </div>
  </div>

  <h1 id="welcome">ë¡œê·¸ì¸ í™•ì¸ ì¤‘...</h1>

  <!-- ì¹´í…Œê³ ë¦¬ íƒ­ -->
  <div class="tabs">
    <button class="tab active" data-filter="all">ì „ì²´</button>
    <button class="tab" data-filter="bot">ë””ìŠ¤ì½”ë“œ ë´‡</button>
    <button class="tab" data-filter="design">ë””ìì¸</button>
    <button class="tab" data-filter="hosting">í˜¸ìŠ¤íŒ…</button>
  </div>

  <div id="product-list"></div>

  <div class="btn-row">
    <button class="discord-btn" id="discord-btn">ğŸ™ˆ ë””ìŠ¤ì½”ë“œ</button>
    <button class="logout-btn" id="logout-btn">ë¡œê·¸ì•„ì›ƒ</button>
    <button class="inquiry-main-btn" id="inquiry-btn">ë¬¸ì˜í•˜ê¸°</button>
    <button class="reset-btn" id="reset-points-btn">í¬ì¸íŠ¸ ì´ˆê¸°í™”</button>
  </div>
</div>

<script type="module">
import { auth, db } from "./firebase.js";
import {
  onAuthStateChanged,
  signOut
} from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
import {
  doc,
  getDoc,
  setDoc,
  updateDoc,
  increment
} from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

const welcomeEl = document.getElementById("welcome");
const productList = document.getElementById("product-list");
const logoutBtn = document.getElementById("logout-btn");
const discordBtn = document.getElementById("discord-btn");
const inquiryBtn = document.getElementById("inquiry-btn");
const resetBtn = document.getElementById("reset-points-btn");
const tabs = document.querySelectorAll(".tab");
  
const products = [
  {name:"ğŸš€ ë””ìŠ¤ì½”ë“œ ë´‡ ì¼ë°˜",price:"â‚©15,000",desc:"ê¸°ëŠ¥ ë§ì¶¤ ì œì‘ 1ê°œ", tag:"bot", badge:"ê¸°ë³¸ ë´‡ ì œì‘"},
  {name:"ğŸš€ ë””ìŠ¤ì½”ë“œ ë´‡ ê³ ê¸‰",price:"â‚©30,000",desc:"ê²Œì„ ë´‡ ì‹œìŠ¤í…œ ì ìš© ë“±", tag:"bot", badge:"ê³ ê¸‰ ê¸°ëŠ¥"},
  {name:"â˜ï¸ ë””ìŠ¤ì½”ë“œ í…œí”Œë¦¿",price:"â‚©5,000",desc:"ì—­í•  & ê¸°ë³¸ ì„¸íŒ…", tag:"bot", badge:"í…œí”Œë¦¿"},
  {name:"â˜ï¸ í”„ë¦¬ë¯¸ì—„ í•´ì™¸ í˜¸ìŠ¤íŒ…",price:"ì›”â‚©10,000 ~ì‹œì‘",desc:"99.9% ë””ë„ìŠ¤ ë³´í˜¸ ì™„ë²½ ì°¨ë‹¨ ë¹½ì—… ê¸°ëŠ¥", tag:"hosting", badge:"í˜¸ìŠ¤íŒ…"},
  {name:"â˜ï¸ í”„ë¡œí•„",price:"â‚©3,000 ~ ì‹œì‘",desc:"ì´ìœ ì„ ìƒë‹˜ì´ í•´ì£¼ì…”ìš”", tag:"design", badge:"í”„ë¡œí•„ ë””ìì¸"},
  {name:"â˜ï¸ ë¡œê³ ",price:"â‚©10,000 ~ ì‹œì‘",desc:"í™ˆí˜ì´ì§€/ë””ìŠ¤ì½”ë“œ/ë¡œê³ /ë“±", tag:"design", badge:"ë¡œê³  ë””ìì¸"},
];

// ìƒí’ˆ ë Œë”
function renderProducts(filter = "all") {
  productList.innerHTML = "";

  products
    .filter(p => filter === "all" || p.tag === filter)
    .forEach((product, index) => {
      const div = document.createElement("div");
      div.className = "product";
      div.innerHTML = `
        <h3>${product.name}</h3>
        <p>${product.price}</p>
        <small>${product.desc}</small>
        <div class="product-footer">
          <span class="badge">${product.badge}</span>
          <button class="buy-btn" data-index="${index}">êµ¬ë§¤í•˜ê¸°</button>
        </div>
      `;
      productList.appendChild(div);
    });

  attachBuyEvents();
}

// êµ¬ë§¤í•˜ê¸° ë²„íŠ¼ í´ë¦­ ì‹œ í¬ì¸íŠ¸ ì ë¦½ + ë””ìŠ¤ì½”ë“œìš© ë©”ì‹œì§€ ë³µì‚¬
async function attachBuyEvents() {
  const buttons = document.querySelectorAll(".buy-btn");

  buttons.forEach(btn => {
    btn.onclick = async () => {
      const user = auth.currentUser;
      if (!user) {
        alert("ë¡œê·¸ì¸ í›„ ì´ìš©í•´ ì£¼ì„¸ìš”.");
        return;
      }

      const uid = user.uid;
      const nickname = user.email.split("@")[0];
      const idx = btn.getAttribute("data-index");
      const product = products[idx];

      const userRef = doc(db, "users", uid);

      // í¬ì¸íŠ¸ +10
      await updateDoc(userRef, {
        points: increment(10)
      });

      // ìµœì‹  í¬ì¸íŠ¸ ì¡°íšŒ
      const snap = await getDoc(userRef);
      const points = snap.data().points ?? 0;

      welcomeEl.textContent = `í™˜ì˜í•©ë‹ˆë‹¤, ${nickname}ë‹˜! (í¬ì¸íŠ¸: ${points}ì ) ğŸ‘‹`;

      const msg = `ğŸ§¾ ë¼ë‹ˆ MALL êµ¬ë§¤ ìš”ì²­

ğŸ‘¤ êµ¬ë§¤ì: ${nickname}
ğŸ“§ ì´ë©”ì¼: ${user.email}
í¬ì¸íŠ¸: ${points}ì 

ğŸ›’ ìƒí’ˆëª…: ${product.name}
ğŸ’° ê°€ê²©: ${product.price}
ğŸ“„ ì„¤ëª…: ${product.desc}

ìœ„ ìƒí’ˆ êµ¬ë§¤ë¥¼ í¬ë§í•©ë‹ˆë‹¤.`;

      navigator.clipboard.writeText(msg).then(() => {
        alert("êµ¬ë§¤ ìš”ì²­ í…ìŠ¤íŠ¸ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤. ë””ìŠ¤ì½”ë“œì—ì„œ ë¶™ì—¬ë„£ê¸° í•´ ì£¼ì„¸ìš”. (í¬ì¸íŠ¸ +10 ì ë¦½ ì™„ë£Œ)");
        window.open("https://discord.gg/yEym2KZ9BU", "_blank");
      }).catch(() => {
        prompt("ì•„ë˜ ë‚´ìš©ì„ ë””ìŠ¤ì½”ë“œë¡œ ë³´ë‚´ì£¼ì„¸ìš”:", msg);
        window.open("https://discord.gg/yEym2KZ9BU", "_blank");
      });
    };
  });
}

// í¬ì¸íŠ¸ ì´ˆê¸°í™” ë²„íŠ¼
resetBtn.onclick = async () => {
  const user = auth.currentUser;
  if (!user) {
    alert("ë¡œê·¸ì¸ í›„ ì´ìš©í•´ ì£¼ì„¸ìš”.");
    return;
  }

  const ok = confirm("ì •ë§ í¬ì¸íŠ¸ë¥¼ 0ì ìœ¼ë¡œ ì´ˆê¸°í™”í• ê¹Œìš”?");
  if (!ok) return;

  const uid = user.uid;
  const userRef = doc(db, "users", uid);

  await updateDoc(userRef, { points: 0 });  // ì´ ìœ ì € í¬ì¸íŠ¸ 0ìœ¼ë¡œ ì´ˆê¸°í™”[web:176][web:180]

  const snap = await getDoc(userRef);
  const nickname = user.email.split("@")[0];
  const points = snap.data().points ?? 0;

  welcomeEl.textContent = `í™˜ì˜í•©ë‹ˆë‹¤, ${nickname}ë‹˜! (í¬ì¸íŠ¸: ${points}ì ) ğŸ‘‹`;
  alert("í¬ì¸íŠ¸ê°€ 0ì ìœ¼ë¡œ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.");
};

// ì•„ë˜ í° ë¬¸ì˜í•˜ê¸° ë²„íŠ¼
inquiryBtn.onclick = () => {
  const message = `ğŸ¯ ë¼ë‹ˆ MALL ë¬¸ì˜
ğŸ’° ê°€ê²© ë° ìƒí’ˆ ë¬¸ì˜

ğŸ‘¤ Discord: soyugwon
ğŸ”— https://discord.gg/yEym2KZ9BU

ğŸ‘‡ ì•„ë˜ ë””ìŠ¤ì½”ë“œ ë²„íŠ¼ì„ ëˆŒëŸ¬ ë¬¸ì˜ë¥¼ ë³´ë‚´ì£¼ì„¸ìš”.`;

  navigator.clipboard.writeText(message).then(() => {
    alert("ë¬¸ì˜ í…ìŠ¤íŠ¸ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤. ë””ìŠ¤ì½”ë“œì—ì„œ ë¶™ì—¬ë„£ê¸° í•´ ì£¼ì„¸ìš”.");
  }).catch(() => {
    prompt("ë””ìŠ¤ì½”ë“œë¡œ ë³´ë‚´ì„¸ìš”:", message);
  });
};

let statusInterval;
function updateStatus() {
  const now = new Date().toLocaleString("ko-KR", {
    hour12: false, timeZone: "Asia/Seoul",
    year: "numeric", month: "2-digit", day: "2-digit",
    hour: "2-digit", minute: "2-digit", second: "2-digit"
  });
  document.getElementById("status").textContent = `ğŸŸ¢ ì˜¨ë¼ì¸ | ${now}`;
}

// íƒ­ í•„í„° ì´ë²¤íŠ¸
tabs.forEach(tab => {
  tab.addEventListener("click", () => {
    tabs.forEach(t => t.classList.remove("active"));
    tab.classList.add("active");
    const filter = tab.getAttribute("data-filter");
    renderProducts(filter);
  });
});

// ë¡œê·¸ì¸ ìƒíƒœ ì²´í¬ + Firestore ìœ ì €/í¬ì¸íŠ¸ ì„¸íŒ…
onAuthStateChanged(auth, async (user) => {
  if (user) {
    const uid = user.uid;
    const nickname = user.email.split('@')[0];

    const userRef = doc(db, "users", uid);
    const snap = await getDoc(userRef);

    // ì²˜ìŒ ë¡œê·¸ì¸í•œ ìœ ì €ë©´ ê¸°ë³¸ ì •ë³´ + í¬ì¸íŠ¸ 0
    if (!snap.exists()) {
      await setDoc(userRef, {
        email: user.email,
        nickname: nickname,
        points: 0
      });
    }

    // ìµœì‹  í¬ì¸íŠ¸ ë‹¤ì‹œ ì½ê¸°
    const refreshed = await getDoc(userRef);
    const points = refreshed.data().points ?? 0;

    welcomeEl.textContent = `í™˜ì˜í•©ë‹ˆë‹¤, ${nickname}ë‹˜! (í¬ì¸íŠ¸: ${points}ì ) ğŸ‘‹`;

    renderProducts();
    statusInterval = setInterval(updateStatus, 1000);
    updateStatus();
  } else {
    window.location.href = "index.html";
  }
});

// ë¡œê·¸ì•„ì›ƒ
logoutBtn.onclick = async () => {
  logoutBtn.disabled = true;
  logoutBtn.textContent = "ë¡œê·¸ì•„ì›ƒ ì¤‘...";
  try { await signOut(auth); }
  catch (error) { console.error("ë¡œê·¸ì•„ì›ƒ ì˜¤ë¥˜:", error); }
};

// ë””ìŠ¤ì½”ë“œ ë²„íŠ¼
discordBtn.onclick = () => window.open("https://discord.gg/yEym2KZ9BU", "_blank");

// ESC ë¡œ ë¡œê·¸ì•„ì›ƒ
document.addEventListener("keydown", (e) => {
  if (e.key === "Escape") logoutBtn.click();
});
</script>
</body>
</html>
