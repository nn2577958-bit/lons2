<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LONS SV Palworld</title>
<link rel="icon" href="https://cdn.phototourl.com/uploads/2026-02-16-b555cb64-84f5-4ab4-b235-73d0d2be6482.png" type="image/png">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
<style>
body{margin:0;font-family:'Segoe UI',sans-serif;background:#111;color:white;}
.container{max-width:900px;margin:auto;padding:20px;}
h1,h2{margin:10px 0;}
button{padding:10px 20px;border:none;border-radius:6px;cursor:pointer;margin:5px 0;}
button:hover{opacity:0.9;}
#admin-status{margin:10px 0;padding:6px 12px;border-radius:8px;background:rgba(0,0,0,0.5);display:inline-block;}
#login-msg{color:#ff4444;margin-bottom:10px;}
input,textarea{width:100%;margin:5px 0;padding:8px;border-radius:6px;border:1px solid #ccc;}
.notice-item{background:#1c1c1c;padding:15px;border-radius:10px;margin:10px 0;border-left:5px solid #4CAF50;}
</style>
</head>
<body>
<div class="container">
  <h1>LONS SV Palworld</h1>
  <div id="admin-status">ğŸ”´ ê´€ë¦¬ì ì˜¤í”„ë¼ì¸</div>
  <div id="login-msg"></div>
  <button id="google-btn"><i class="fab fa-google"></i> Google ë¡œê·¸ì¸</button>
  <button id="discord-btn" class="disabled" data-tooltip="ë¡œê·¸ì¸ í›„ í™œì„±í™”ë©ë‹ˆë‹¤"><i class="fab fa-discord"></i> Discord ì°¸ì—¬í•˜ê¸°</button>

  <hr>

  <h2>ê³µì§€ì‚¬í•­</h2>
  <div id="notice-list"></div>

  <hr>

  <h2>ì»¤ë®¤ë‹ˆí‹° ê¸€ì“°ê¸°</h2>
  <input type="text" id="author" placeholder="ì‘ì„±ì">
  <input type="text" id="title" placeholder="ì œëª©">
  <textarea id="content" rows="3" placeholder="ë‚´ìš©"></textarea>
  <button id="post-btn">ê²Œì‹œê¸€ ì‘ì„±</button>

  <h2>ê²Œì‹œê¸€ ëª©ë¡</h2>
  <div id="posts-container"></div>
</div>

<script type="module">
// Firebase ì´ˆê¸°í™”
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
import { getFirestore, collection, addDoc, getDocs, query, orderBy, serverTimestamp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBeoiT7Bh0r83YY4Ga52auTmA5X92DMzKQ",
  authDomain: "lons2-74bfa.firebaseapp.com",
  projectId: "lons2-74bfa",
  storageBucket: "lons2-74bfa.appspot.com",
  messagingSenderId: "734178165313",
  appId: "1:734178165313:web:395ed759777ec61f4b3cc0"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

const ADMIN_EMAIL = "nn2577958@gmail.com";

const adminStatus = document.getElementById("admin-status");
const loginMsg = document.getElementById("login-msg");
const googleBtn = document.getElementById("google-btn");
const discordBtn = document.getElementById("discord-btn");

const noticeList = document.getElementById("notice-list");
const postsContainer = document.getElementById("posts-container");
const postBtn = document.getElementById("post-btn");
const authorInput = document.getElementById("author");
const titleInput = document.getElementById("title");
const contentInput = document.getElementById("content");

let opacity = 1;
let fadingOut = true;

// ê´€ë¦¬ì ìƒíƒœ + ê¹œë°•ì„
function updateAdminClock(user){
  const now = new Date();
  const kst = now.toLocaleString("ko-KR",{hour12:false, timeZone:"Asia/Seoul"});
  const isOnline = user?.email === ADMIN_EMAIL;
  adminStatus.innerHTML = `${isOnline ? "ğŸŸ¢ ê´€ë¦¬ì ì˜¨ë¼ì¸" : "ğŸ”´ ê´€ë¦¬ì ì˜¤í”„ë¼ì¸"}<br>${kst}`;

  fadingOut ? opacity-=0.05 : opacity+=0.05;
  if(opacity<=0) fadingOut=false;
  if(opacity>=1) fadingOut=true;
  adminStatus.style.opacity = opacity;
}
setInterval(()=>updateAdminClock(auth.currentUser),1000);

// ë¡œê·¸ì¸ ìƒíƒœ ê°ì§€
onAuthStateChanged(auth,user=>{
  if(user){
    discordBtn.classList.remove("disabled");
    discordBtn.removeAttribute("data-tooltip");
  }else{
    discordBtn.classList.add("disabled");
    discordBtn.setAttribute("data-tooltip","ë¡œê·¸ì¸ í›„ í™œì„±í™”ë©ë‹ˆë‹¤");
  }
});

// Google ë¡œê·¸ì¸
googleBtn.addEventListener("click", async ()=>{
  googleBtn.disabled = true;
  loginMsg.textContent="";
  const provider = new GoogleAuthProvider();
  try{
    await signInWithPopup(auth,provider);
    loginMsg.textContent="ë¡œê·¸ì¸ ì„±ê³µ! Discord ë²„íŠ¼ì´ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.";
  }catch(err){
    loginMsg.textContent="ë¡œê·¸ì¸ ì‹¤íŒ¨: "+err.message;
    googleBtn.disabled=false;
  }
});

// Discord ë²„íŠ¼
discordBtn.addEventListener("click", ()=>{
  if(discordBtn.classList.contains("disabled")){
    loginMsg.textContent="êµ¬ê¸€ ë¡œê·¸ì¸ í›„ ë²„íŠ¼ì´ í™œì„±í™”ë©ë‹ˆë‹¤!";
    return;
  }
  loginMsg.textContent="ì ì‹œ í›„ ì´ë™...";
  setTimeout(()=>window.location.href="#",1500); // ì›í•˜ëŠ” í˜ì´ì§€ë¡œ ë³€ê²½ ê°€ëŠ¥
});

// ê³µì§€ì‚¬í•­ ì˜ˆì‹œ
const notices = [
  {title:"ê³µì§€ì‚¬í•­", content:"í•­ìƒ ëª¨ë‹ˆí„°ë§ ì¤‘ì´ë©° ëª¨ë“  íŒŒì¼ì€ ë°ì´í„°ë² ì´ìŠ¤ì— ê¸°ë¡ë©ë‹ˆë‹¤.", createdAt:"2026-02-17 12:00"},
  {title:"ì‹ ê·œ ì´ë²¤íŠ¸", content:"ë‹¹ì²¨ìì—ê²Œ ì§€ê¸‰ ì²˜ë¦¬ë©ë‹ˆë‹¤.", createdAt:"2026-02-16 14:00"},
];
function renderNotices(){
  noticeList.innerHTML="";
  notices.forEach(n=>{
    const div=document.createElement("div");
    div.className="notice-item";
    div.innerHTML=`<strong>${n.title}</strong> <small>${n.createdAt}</small><div>${n.content}</div>`;
    noticeList.appendChild(div);
  });
}
renderNotices();

// ê²Œì‹œê¸€ ë¶ˆëŸ¬ì˜¤ê¸°
async function loadPosts(){
  postsContainer.innerHTML="";
  const q=query(collection(db,"posts"),orderBy("createdAt","desc"));
  const snapshot=await getDocs(q);
  snapshot.forEach(doc=>{
    const d=doc.data();
    const div=document.createElement("div");
    div.className="notice-item";
    div.innerHTML=`<strong>${d.title}</strong> <small>${d.createdAt?.seconds ? new Date(d.createdAt.seconds*1000).toLocaleString() : ""}</small><div>${d.content}</div>`;
    postsContainer.appendChild(div);
  });
}
loadPosts();

// ê¸€ì“°ê¸°
postBtn.addEventListener("click", async ()=>{
  const author = authorInput.value.trim();
  const title = titleInput.value.trim();
  const content = contentInput.value.trim();
  if(!author || !title || !content) return alert("ëª¨ë“  í•„ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!");
  await addDoc(collection(db,"posts"),{
    author, title, content, createdAt: serverTimestamp()
  });
  authorInput.value=""; titleInput.value=""; contentInput.value="";
  loadPosts();
});
</script>
</body>
</html>
